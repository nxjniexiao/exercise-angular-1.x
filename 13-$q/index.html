<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>$q</title>
</head>
<body ng-app="myApp">
<div ng-controller="MyController as myCtrl">
</div>
<script src="../lib/angular.min.js"></script>
<script>
  (function (angular) {
    angular.module('myApp', []).controller('MyController', [
      '$scope', '$q', '$timeout',
      function ($scope, $q, $timeout) {

        function test() {
          return $q(function (resolve, reject) {
            $timeout(function () {
              if (Math.random() > 0.5) {
                resolve('Hello world!');
              } else {
                reject({message: 'rejected'});
              }
            })
          })
        }
        // 测试
        test().then(function (res) {
          console.log(res);
          return res;
        }).then(function (res) {
          console.log(res);
          return res;
        }).then(function (res) {
          console.log(res);
        }).catch(function (err) {
          console.log(err);
        });
      }
    ]);
  })(window.angular);
</script>
<!-- 自定义 JS -->
</body>
</html>
